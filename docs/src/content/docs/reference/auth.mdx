---
title: Authentication
description: Comprehensive reference for GitHub Actions secrets, GitHub tokens and GitHub Apps in gh-aw
sidebar:
  order: 650
disable-agentic-editing: true
---

import { Card, CardGrid } from '@astrojs/starlight/components';
import Video from '../../../components/Video.astro';

This page describes authentication settings for GitHub Agentic Workflows, including:

- GitHub Actions secrets, API Keys and tokens required for different AI engines
- GitHub tokens for GitHub tools and safe outputs
- Using a GitHub App as an alternative for authorization

## Which GitHub Actions secrets do I need?

You will need one of the following GitHub Actions secrets configured in your repository to authenticate the AI engine you choose:

- **Copilot** – Add [`COPILOT_GITHUB_TOKEN`](#copilot_github_token)
- **Claude by Anthropic** – Add [`ANTHROPIC_API_KEY`](#anthropic_api_key)
- **Codex by OpenAI** – Add [`OPENAI_API_KEY`](#openai_api_key)
- **Gemini by Google** – Add [`GEMINI_API_KEY`](#gemini_api_key)

Depending on what your workflow needs to do, you may need additional GitHub tokens added as repository secrets:

- **Cross-repo access** – Add [`GH_AW_GITHUB_TOKEN`](#gh_aw_github_token)
- **Trigger CI on PRs created by workflows** – Use [`GH_AW_CI_TRIGGER_TOKEN`](#gh_aw_ci_trigger_token)
- **Assign Copilot coding agent to issues/PRs** – Add [`GH_AW_AGENT_TOKEN`](#gh_aw_agent_token)
- **Lockdown mode** – Add [`GH_AW_GITHUB_TOKEN`](#gh_aw_github_token)
- **Remote GitHub tools mode** – Add [`GH_AW_GITHUB_TOKEN`](#gh_aw_github_token)
- **GitHub Projects operations** – Add [`GH_AW_PROJECT_GITHUB_TOKEN`](#gh_aw_project_github_token)
- **Give GitHub MCP server special permissions** – Add [`GH_AW_GITHUB_MCP_SERVER_TOKEN`](#gh_aw_github_mcp_server_token)

## How do I add a GitHub Actions secret to my repository?

You can add secrets manually in the GitHub UI or use the CLI for a streamlined experience.

### Adding secrets using the CLI

```bash
gh aw secrets set COPILOT_GITHUB_TOKEN --value "YOUR_COPILOT_PAT"
```

You can also check existing secrets with:

```bash
gh aw secrets bootstrap
```

If you're working in Codespaces, use the GitHub UI method below to add secrets.

### Adding secrets using the GitHub UI

1. Go to your repository on GitHub
2. Click on "Settings" → "Secrets and variables" → "Actions"
3. Click "New repository secret" and add the token name and value

<picture>
  <source media="(prefers-color-scheme: dark)" srcSet="/gh-aw/images/actions-secrets_dark.png" />
  <img alt="Repository secrets page showing configured tokens" src="/gh-aw/images/actions-secrets_light.png" />
</picture>

## GitHub Actions secrets and tokens

A reference for all GitHub Actions secrets and tokens used by GitHub Agentic Workflows, including when they are needed and how to set them up.

### `COPILOT_GITHUB_TOKEN`

If using Copilot as your AI engine, you need a GitHub Actions Secret set to a GitHub Personal Access Token (PAT) to authenticate Copilot CLI.

**Setup**:

Create a [fine-grained PAT](https://github.com/settings/personal-access-tokens/new):

1. Select your **user account**, not an organization.
2. Choose **Public repositories**, even if you will be using it with private repositories. This is required for the "Copilot Requests" permission to be available.
3. Click **Add permissions** and choose **Copilot Requests**.
4. Click **Generate token** and copy the token value.
5. Add the PAT to your GitHub Actions repository secrets as `COPILOT_GITHUB_TOKEN`, either by CLI or GitHub UI (see video).

   ```bash wrap
   gh aw secrets set COPILOT_GITHUB_TOKEN --value "<your-github-pat>"
   ```

<Video
  src="/gh-aw/videos/create-pat-user-copilot.mp4"
  caption="Creating a fine-grained PAT for user-owned repositories with Copilot permissions"
  aspectRatio="16:9"
  silenced={true}
/>

**Troubleshooting**:

If your workflow fails at the Copilot inference step even with the token set, verify that the token owner's account has an active Copilot license. See [Copilot License or Inference Access Issues](/gh-aw/troubleshooting/common-issues/#copilot-license-or-inference-access-issues) for a local diagnostic step.

---

### `ANTHROPIC_API_KEY`

If using the Claude by Anthropic engine, you need to set a GitHub Actions secret `ANTHROPIC_API_KEY` to be an API key from Anthropic.

**Setup**:

1. Create an API key at https://platform.claude.com/docs/en/get-started

2. Add it to your repository secrets:

   ```bash wrap
   gh aw secrets set ANTHROPIC_API_KEY --value "YOUR_ANTHROPIC_API_KEY"
   ```

See also [Using Claude Code](/gh-aw/reference/engines/#using-claude-by-anthropic-claude-code) for additional configuration needed when using Claude with GitHub MCP.

---

### `OPENAI_API_KEY`

If using the Codex by OpenAI engine, you need to set a GitHub Actions secret `OPENAI_API_KEY` with an API key from OpenAI.

**Setup**:

1. Create an API key at https://platform.openai.com/api-keys

2. Add it to your repository secrets:

   ```bash wrap
   gh aw secrets set OPENAI_API_KEY --value "YOUR_OPENAI_API_KEY"
   ```

See also [Using Codex](/gh-aw/reference/engines/#using-openai-codex) for additional configuration needed when using Codex with GitHub MCP.

---

### `GEMINI_API_KEY`

If using the Gemini by Google engine, you need to set a GitHub Actions secret `GEMINI_API_KEY` with an API key from Google AI Studio.

**Setup**:

1. Create an API key at https://aistudio.google.com/api-keys

2. Add it to your repository secrets:

   ```bash wrap
   gh aw secrets set GEMINI_API_KEY --value "YOUR_GEMINI_API_KEY"
   ```

See also [Using Gemini](/gh-aw/reference/engines/#using-google-gemini-cli) for additional configuration needed when using Gemini with GitHub MCP.

---

### `GH_AW_GITHUB_TOKEN`

This token a GitHub Personal Access Token (PAT) used to give added capabilities to most operations within a workflow.

**When Required**:

- **Safe outpus must perform cross-repository operations**: Required for accessing other repositories beyond the current one.
- **Remote GitHub tools mode**: Required for faster startup without Docker.

**Setup**:

1. Create a GitHub Personal Access Token (PAT) with the necessary scopes based on your workflow's operations. For example, if your workflow interacts with issues and pull requests, you would need `repo` scope for private repositories or `public_repo` for public repositories.

2. Configure in your workflow frontmatter for specific safe outputs:

   ```bash wrap
    github-token: ${{ secrets.GH_AW_GITHUB_MCP_SERVER_TOKEN }}
   ```

    Or add to repository secrets:
  
    ```bash wrap
    gh aw secrets set GH_AW_GITHUB_TOKEN --value "<your-pat-token>"
    ```

Note that using `GH_AW_GITHUB_TOKEN` replaces the default behaviour of GitHub Agentic Workflows (which arranges temporary `GITHUB_TOKEN` GitHub Actions tokens appropriate to the `permissions:` you have declared).

---

### `GH_AW_GITHUB_MCP_SERVER_TOKEN`

This token is a GitHub Personal Access Token (PAT) that can be used to give the GitHub MCP server a different authentication context than the rest of the workflow. This is optional and only needed if you want to isolate permissions for MCP server operations or are using remote GitHub tools mode and need a token with specific scopes.

**When to use**:

Required when your workflow uses:
- Read access to GitHub org or user information
- Read access to other private repos
- `lockdown: true` for GitHub tools
- `mode: remote` for GitHub tools

**Setup**:

1. Create a [fine-grained PAT](https://github.com/settings/personal-access-tokens/new) with:

   - **Repository access**:
     - Select specific repos or "All repositories"
   - **Repository permissions** (based on your GitHub tools usage):
     - Contents: Read (minimum for toolset: repos)
     - Issues: Read (for toolset: issues)
     - Pull requests: Read (for toolset: pull_requests)
     - Adjust based on the toolsets you configure in your workflow

2. Configure in your workflow frontmatter:

   ```yaml wrap
   tools:
     github:
       github-token: ${{ secrets.GH_AW_GITHUB_MCP_SERVER_TOKEN }}
   ```

   Or add to repository secrets:

   ```bash wrap
   gh aw secrets set GH_AW_GITHUB_MCP_SERVER_TOKEN --value "<your-pat-token>"
   ```

---

### `GH_AW_CI_TRIGGER_TOKEN`

Pull requests and pushes made with `GITHUB_TOKEN` do not trigger `pull_request`, `push`, or `pull_request_target` events. This is a GitHub Actions feature to prevent event cascades.

See [Triggering CI](/gh-aw/reference/triggering-ci/) for how to configure CI triggers on PRs created by workflows using `

---

### `GH_AW_PROJECT_GITHUB_TOKEN`

This token is a GitHub Personal Access Token (PAT) required for [GitHub Projects](https://docs.github.com/en/issues/planning-and-tracking-with-projects/learning-about-projects/about-projects) operations, since the default `GITHUB_TOKEN` cannot access the Projects API.

**When to use**:

Required when your workflow uses:
- Read access to projects
- Safe outpus to update or create projects

**Setup**:

The required token type depends on whether you're working with **user-owned** or **organization-owned** Projects:

**For User-owned Projects**:

<Video
  src="/gh-aw/videos/create-pat-user-project.mp4"
  caption="Creating a classic PAT for user-owned private projects"
  aspectRatio="16:9"
  silenced={true}
/>

You **must** use a **classic PAT** with the `project` scope. Fine-grained PATs do **not** work with user-owned Projects.

1. Create a [classic PAT](https://github.com/settings/tokens/new) with scopes:
   - `project` (required for user Projects)
   - `repo` (required if accessing private repositories)

**For Organization-owned Projects (v2)**:

<Video
  src="/gh-aw/videos/create-pat-org-project.mp4"
  caption="Creating a fine-grained PAT for organization-owned projects"
  aspectRatio="16:9"
  silenced={true}
/>

You can use either a classic PAT or a fine-grained PAT:

1. **Option A**: Create a **classic PAT** with `project` and `read:org` scopes:
   - `project` (required)
   - `read:org` (required for org Projects)
   - `repo` (required if accessing private repositories)

2. **Option B (recommended)**: Create a [fine-grained PAT](https://github.com/settings/personal-access-tokens/new) with:
   - **Repository access**: Select specific repos that will use the workflow
   - **Repository permissions**:
     - Contents: Read
     - Issues: Read (if needed for issue-triggered workflows)
     - Pull requests: Read (if needed for PR-triggered workflows)
   - **Organization permissions** (must be explicitly granted):
     - Projects: Read & Write (required for updating org Projects)
   - **Important**: You must explicitly grant organization access during token creation

3. **Option C**: Use a GitHub App with Projects: Read+Write permission

After creating your token, add it to repository secrets:

```bash wrap
gh aw secrets set GH_AW_PROJECT_GITHUB_TOKEN --value "YOUR_PROJECT_PAT"
```

**Token precedence and fallback**:

per-safe-output -> `GH_AW_PROJECT_GITHUB_TOKEN` -> `GITHUB_TOKEN`.

**Example configuration**:

```yaml wrap
---
# Option 1: Use GH_AW_PROJECT_GITHUB_TOKEN secret (recommended for org Projects)
# Just create the secret - no workflow config needed
---

# Option 2: Explicitly configure at safe-output level
safe-outputs:
  update-project:
    github-token: ${{ secrets.CUSTOM_PROJECT_TOKEN }}

# Option 3: Organization projects with GitHub tools integration
tools:
  github:
    toolsets: [default, projects]
    github-token: ${{ secrets.ORG_PROJECT_WRITE }}
safe-outputs:
  update-project:
    github-token: ${{ secrets.ORG_PROJECT_WRITE }}
```

**Notes**:

- For organization-owned projects, configure both GitHub tools and safe outputs with the same token.
- Default behavior: `update-project` is update-only. It will not create projects. If a project does not exist, the job fails with instructions to create it manually.
- The default `GITHUB_TOKEN` cannot be used for Projects v2 operations. Configure `GH_AW_PROJECT_GITHUB_TOKEN` or provide a custom token via `safe-outputs.update-project.github-token`.
- **GitHub Projects v2 PAT Requirements**:
  - **User-owned Projects**: Require a classic PAT with the `project` scope (plus `repo` if accessing private repos). Fine-grained PATs do not work with user-owned Projects.
  - **Organization-owned Projects**: Can use either a classic PAT with `project` + `read:org` scopes, or a fine-grained PAT with:
    - Repository access to specific repositories
    - Repository permissions: Contents: Read, Issues: Read, Pull requests: Read (as needed)
    - Organization permissions: Projects: Read & Write
    - Explicit organization access granted during token creation
  - **GitHub App**: Works for both user and org Projects with Projects: Read+Write permission.
- To opt-in to creating projects, the agent must include `create_if_missing: true` in its output, and the token must have sufficient permissions to create projects in the organization.
- Use `GH_AW_PROJECT_GITHUB_TOKEN` for Projects-specific isolation; use `GH_AW_GITHUB_TOKEN` if it already has Projects permissions and you do not need isolation.

---

### `GH_AW_AGENT_TOKEN`

This token is a GitHub Personal Access Token (PAT) required to programmatically assign the GitHub platform's asynchronous [Copilot coding agent](https://docs.github.com/en/copilot/concepts/agents/coding-agent/about-coding-agent) to issues or pull requests.

**When to use**:

Required when your workflow uses:
- `assign-to-agent:` safe output, or
- `assignees: copilot` in `create-issue` safe output

**Setup**:

The required token type and permissions depend on whether you own the repository or an organization owns it:

**For User-owned Repositories**:

1. Create a [fine-grained PAT](https://github.com/settings/personal-access-tokens/new) with:
   - **Resource owner**: Your user account
   - **Repository access**: "Public repositories" or select specific repos
   - **Repository permissions**:
     - Actions: Write
     - Contents: Write
     - Issues: Write
     - Pull requests: Write

**For Organization-owned Repositories**:

<Video
  src="/gh-aw/videos/create-pat-org-agent.mp4"
  caption="Creating a fine-grained PAT for organization-owned repositories with permissions for agent assignment"
  aspectRatio="16:9"
  silenced={true}
/>

When an organization owns the repository, you need a fine-grained PAT with the resource owner set to the organization:

1. Create a [fine-grained PAT](https://github.com/settings/personal-access-tokens/new) with:
   - **Resource owner**: The organization that owns the repository
   - **Repository access**: Select the specific repositories that will use the workflow
   - **Repository permissions**:
     - Actions: Write
     - Contents: Write
     - Issues: Write
     - Pull requests: Write
   - **Important**: You must set the resource owner to the organization during token creation

2. Add to repository secrets:

```bash wrap
gh aw secrets set GH_AW_AGENT_TOKEN --value "YOUR_AGENT_PAT"
```

**Token precedence and fallback**:

`GH_AW_AGENT_TOKEN` -> `GH_AW_GITHUB_TOKEN` -> `GITHUB_TOKEN`.

**Resource owner requirements**: The token's resource owner must match the repository ownership:
- **User-owned repositories**: Use a token where the resource owner is your user account
- **Organization-owned repositories**: Use a token where the resource owner is the organization

This ensures the token has the appropriate permissions to assign agents to issues and pull requests in the repository.

**Note: There are two ways to assign the GitHub platform's asynchronous [Copilot coding agent](https://docs.github.com/en/copilot/concepts/agents/coding-agent/about-coding-agent)** (CCA)

There are two different methods for assigning issues or pull requests to CCA. Both methods use the same token (`GH_AW_AGENT_TOKEN`) and GraphQL API to perform the assignment:

1. Via [`assign-to-agent` safe output**](/gh-aw/reference/safe-outputs/#assign-to-agent-assign-to-agent)

2. Via [`assignees` field in `create-issue` safe output](/gh-aw/reference/safe-outputs/#issue-creation-create-issue): Required when creating new issues through workflows and want to assign the agent immediately. When `copilot` is in the assignees list, it is automatically filtered out and assigned via GraphQL in a separate step after issue creation (using the same token and API as method 1).

```yaml
safe-outputs:
  create-issue:
    assignees: copilot  # or assignees: [copilot, user1]
```

Both methods result in the same outcome as [manually assigning issues to Copilot through the GitHub UI](https://docs.github.com/en/copilot/how-tos/use-copilot-agents/coding-agent/create-a-pr#assigning-an-issue-to-copilot). Method 2 is simpler when creating issues, while method 1 provides fine-grained control for existing issues.

---

## Using a GitHub App for Authentication

For enhanced security with short-lived tokens, you may configure a GitHub App instead of using PATs.

This does not apply to `COPILOT_GITHUB_TOKEN`, which must currently be a PAT. A single GitHub App can be used for all other GitHub authentication needs in GitHub Agentic Workflows, including tool authentication and safe outputs.

After creating your app, configure it in your workflow:

```yaml wrap
permissions:
  contents: read
  issues: read

tools:
  github:
    mode: remote
    toolsets: [repos, issues, pull_requests]
    app:
      app-id: ${{ vars.APP_ID }}
      private-key: ${{ secrets.APP_PRIVATE_KEY }}
      owner: "my-org"                    # Optional: defaults to current repo owner
      repositories: ["repo1", "repo2"]   # Optional: defaults to current repo only
```

Make sure you set up repository variables and secrets:

```bash wrap
gh variable set APP_ID --body "123456"
gh aw secrets set APP_PRIVATE_KEY --value "$(cat path/to/private-key.pem)"
```

At workflow start, a token is automatically minted with **permissions matching your job's `permissions:` field**. The token is passed to the GitHub MCP server and automatically revoked at workflow end (even on failure).

You can also use GitHub App tokens for safe outputs operations:

```yaml wrap
safe-outputs:
  app:
    app-id: ${{ vars.APP_ID }}
    private-key: ${{ secrets.APP_PRIVATE_KEY }}
    owner: "my-org"                    # optional: installation owner
    repositories: ["repo1", "repo2"]   # optional: scope to specific repos
  create-issue:
```

When you configure `app:` for safe outputs, tokens are minted with permissions specific to the safe output operations being performed, rather than the broader job-level permissions. This provides enhanced security by ensuring that tokens have the minimum necessary permissions for their specific use case.

For both tool authentication and safe outputs, you can scope the GitHub App token to specific repositories for enhanced security. This limits the token's access to only the repositories it needs to interact with.

- Omit `repositories` field - Current repository only (default)
- `repositories: ["*"]` - Org-wide access (all repos in the installation)
- `repositories: ["repo1", "repo2"]` - Specific repositories only

---

## Related Documentation

- [Engines](/gh-aw/reference/engines/) - Engine-specific authentication
- [Safe Outputs](/gh-aw/reference/safe-outputs/) - Safe output token configuration
- [Tools](/gh-aw/reference/tools/) - Tool authentication and modes
- [Permissions](/gh-aw/reference/permissions/) - Permission model overview
